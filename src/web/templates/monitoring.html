{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="h4 mb-0">Monitoring sistema</h1>
</div>

<div class="row g-4">
    <div class="col-md-6 col-lg-3">
        <div class="card">
            <div class="card-body">
                <div class="text-muted small mb-1">Stato API</div>
                <div class="d-flex align-items-center">
                    <div class="bg-success rounded-circle me-2" style="width:10px;height:10px;"></div>
                    <div>Operativo</div>
                </div>
                <div class="h5 mt-2">99.9% <small class="text-muted">uptime</small></div>
            </div>
        </div>
    </div>
    <div class="col-md-6 col-lg-3">
        <div class="card">
            <div class="card-body">
                <div class="text-muted small mb-1">Nodo blockchain</div>
                <div class="d-flex align-items-center">
                    <div class="bg-success rounded-circle me-2" style="width:10px;height:10px;"></div>
                    <div>{{ system_health.blockchain_status }}</div>
                </div>
                <div class="h5 mt-2">120ms <small class="text-muted">ping</small></div>
            </div>
        </div>
    </div>
    <div class="col-md-6 col-lg-3">
        <div class="card">
            <div class="card-body">
                <div class="text-muted small mb-1">Database</div>
                <div class="d-flex align-items-center">
                    <div class="bg-success rounded-circle me-2" style="width:10px;height:10px;"></div>
                    <div>{{ system_health.database_status }}</div>
                </div>
                <div class="h5 mt-2">25ms <small class="text-muted">query</small></div>
            </div>
        </div>
    </div>
    <div class="col-md-6 col-lg-3">
        <div class="card">
            <div class="card-body">
                <div class="text-muted small mb-1">OCSP responder</div>
                <div class="d-flex align-items-center">
                    <div class="bg-success rounded-circle me-2" style="width:10px;height:10px;"></div>
                    <div>Operativo</div>
                </div>
                <div class="h5 mt-2">50ms <small class="text-muted">resp.</small></div>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-lg-12">
        <div class="card">
            <div class="card-body">
                <h6 class="text-muted mb-3">Tempo di risposta API (ms)</h6>
                <canvas id="responseTimeChart" height="100"></canvas>
            </div>
        </div>
    </div>
</div>

<script>
// Chart initialization with minimalist styling
const ctx = document.getElementById('responseTimeChart').getContext('2d');
new Chart(ctx, {
    type: 'line',
    data: {
        labels: ['17:10', '17:11', '17:12', '17:13', '17:14', '17:15'],
        datasets: [{
            label: 'Tempo di risposta medio (ms)',
            data: [110, 125, 120, 130, 115, 118],
            borderColor: '#2563eb',
            backgroundColor: 'rgba(37, 99, 235, 0.05)',
            tension: 0.3,
            fill: true
        }]
    },
    options: {
        responsive: true,
        plugins: {
            legend: { display: false }
        },
        scales: {
            x: { grid: { display: false } },
            y: { 
                grid: { color: 'rgba(0,0,0,0.05)' },
                suggestedMin: 50,
                suggestedMax: 200
            }
        }
    }
});
</script>
{% endblock %}